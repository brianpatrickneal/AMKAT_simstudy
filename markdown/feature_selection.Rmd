---
title: 'Simulation Results: PhiMr Filter for Feature Selection'
output:
  html_document:
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, 
                      out.width = "100%")
```


We review results from our simulations for feature selection. 


## Prepare Working Environment

We begin by loading the relevant R packages:
```{r, results='hide', warning=FALSE, message=FALSE}
pkgs_to_load <- c('dplyr', 'ggplot2', 'tidyr', 'viridis', 'cowplot')
lapply(X = pkgs_to_load, FUN = library, character.only = TRUE)
```

We then define directories for relevant scripts and data:
```{r}
dir_main <- dirname(dirname(rstudioapi::getActiveDocumentContext()$path))
dir_src <- file.path(dir_main, 'source_scripts')
source(file.path(dir_src, 'define_directories.R'))
```

Next, we define custom functions and other objects used for plotting:
```{r}
source(file.path(dir_src, "define_plot_functions.R"))
source(file.path(dir_src, "define_plot_settings.R"))
```

All scenarios in this simulation setting share the following parameter values:
```{r}
num_replicates  <- 1000
error_distribution <- 'normal'
signal_strength <- 1
values_for_signal_density <- c('sparse', 'dense')
values_for_sample_size <- c(50, 100, 150, 200)
values_for_error_corr_strength <- c(0, 0.5)
```



## Continuous Features

This section includes scenarios where $\boldsymbol{X}$ is simulated as a multivariate continuous random vector.  

```{r}
x_type <- 'cts'
source(file.path(dir_src, 'initialize_adaptive_across.R'))

# Create filenames and load plot data
files <- adaptiveAcrossPlotFiles()
load(files$plotdata)
```

### Retention Rates for Signal/Noise Variables

We plot the mean value, across all data replicates, of the proportion of signal variables (respectively, noise variables) in the original feature set that appear in the testing subset selected by the PhiMr filter. 

```{r fig.asp = 1.2, fig.width = 7, out.width = "80%"}
makePhimrRetentionPlots(plotdata_phimr)
```


### Effect of PhiMr on Signal Density

We plot the mean value, across all data replicates, of the signal density after applying PhiMr as a proportion of the signal density before applying PhiMr, where signal density is measured as the number of signal variables relative to the total number of feature variables.

```{r fig.asp = 1.2, fig.width = 7, out.width = "80%"}
makePhimrDensityPlots(plotdata_phimr)
```


## Discrete Features

This section includes scenarios where $\boldsymbol{X}$ is simulated as a multivariate discrete random vector representing additive-encoded SNP-set data.  

```{r}
x_type <- 'snp'
source(file.path(dir_src, 'initialize_adaptive_across.R'))

# Create filenames and load plot data
files <- adaptiveAcrossPlotFiles()
load(files$plotdata)
```

### Retention Rates for Signal/Noise Variables

We plot the mean value, across all data replicates, of the proportion of signal variables (respectively, noise variables) in the original feature set that appear in the testing subset selected by the PhiMr filter. 

```{r fig.asp = 1.2, fig.width = 7, out.width = "80%"}
makePhimrRetentionPlots(plotdata_phimr)
```


### Effect of PhiMr on Signal Density

We plot the mean value, across all data replicates, of the signal density after applying PhiMr as a proportion of the signal density before applying PhiMr, where signal density is measured as the number of signal variables relative to the total number of feature variables.

```{r fig.asp = 1.2, fig.width = 7, out.width = "80%"}
makePhimrDensityPlots(plotdata_phimr)
```

